<!-- Generated from c8c9c3f on 2023-10-24 @ 23:01 with Emacs 27.1 (Org mode 9.3) -->
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta author="J. Dylan White"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="stylesheet" href="https://jdylanwhite.github.io/css/code.css"/><link rel="stylesheet" href="https://jdylanwhite.github.io/css/site.css"/><title>Adding Extra Pokedex Information - J. Dylan White</title></head><body><header class="site-header"><div class="container"><div class="site-title"><a class="site-name" href="/">J. Dylan White</a> </div></div><div class="site-masthead"><div class="container"><nav class="nav"><a class="nav-link" href="/">Home</a> <a class="nav-link" href="/projects/">Projects</a> <a class="nav-link" href="/dotfiles/">Dotfiles</a> </nav></div></div></header><div class="container"><div class="site-post"><h1 class="site-post-title">Adding Extra Pokedex Information</h1><p class="site-post-meta">October  4, 2023</p><div id="content"><p>
We have a pretty fleshed out Pokedex dataset now, but I&rsquo;d like to add some extra information, such as Pokemon generation and legendary status. This could probably have been done at the scraping stage, but I have already scraped the data and don&rsquo;t want to hit the server again just to add some known data.
</p>

<h2><a id="load-packages" class="anchor" href="#load-packages">¶</a>Load Packages</h2><div class="outline-text-2" id="text-org44a5ccd">
<p>
First, let&rsquo;s load what we need to run the code. We&rsquo;ll scrape some additional information to get the list of legendary Pokemon, so we&rsquo;ll again rely on <code>rvest</code>.
</p>

<pre><span class="org-ess-modifiers">library</span>(rvest)
<span class="org-ess-modifiers">library</span>(knitr)
<span class="org-ess-modifiers">library</span>(dplyr)</pre>
</div>

<h2><a id="read-scraped-pokedex-data" class="anchor" href="#read-scraped-pokedex-data">¶</a>Read Scraped Pokedex Data</h2><div class="outline-text-2" id="text-org4d3e143">
<p>
Next, read the Pokedex data from the previous step.
</p>

<pre><span class="org-comment-delimiter"># </span><span class="org-comment">Read the pokemon data</span>
pokedex_data <span class="org-ess-assignment">&lt;-</span> read.csv(<span class="org-string">'./data/pokedex.csv'</span>,sep=<span class="org-string">','</span>)

glimpse(pokedex_data)</pre>

<pre class="example">
## Rows: 1,010
## Columns: 20
## $ Number                  &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,…
## $ Name                    &lt;chr&gt; "Bulbasaur", "Ivysaur", "Venusaur", "Charmande…
## $ URLs                    &lt;chr&gt; "https://pokemondb.net/pokedex/bulbasaur", "ht…
## $ Type.1                  &lt;chr&gt; "Grass", "Grass", "Grass", "Fire", "Fire", "Fi…
## $ Type.2                  &lt;chr&gt; "Poison", "Poison", "Poison", NA, NA, "Flying"…
## $ Species                 &lt;chr&gt; "Seed Pokémon", "Seed Pokémon", "Seed Pokémon"…
## $ Height                  &lt;dbl&gt; 0.7, 1.0, 2.0, 0.6, 1.1, 1.7, 0.5, 1.0, 1.6, 0…
## $ Weight                  &lt;dbl&gt; 6.9, 13.0, 100.0, 8.5, 19.0, 90.5, 9.0, 22.5, …
## $ HP                      &lt;int&gt; 45, 60, 80, 39, 58, 78, 44, 59, 79, 45, 50, 60…
## $ Attack                  &lt;int&gt; 49, 62, 82, 52, 64, 84, 48, 63, 83, 30, 20, 45…
## $ Defense                 &lt;int&gt; 49, 63, 83, 43, 58, 78, 65, 80, 100, 35, 55, 5…
## $ Sp..Atk                 &lt;int&gt; 65, 80, 100, 60, 80, 109, 50, 65, 85, 20, 25, …
## $ Sp..Def                 &lt;int&gt; 65, 80, 100, 50, 65, 85, 64, 80, 105, 20, 25, …
## $ Speed                   &lt;int&gt; 45, 60, 80, 65, 80, 100, 43, 58, 78, 45, 30, 7…
## $ Total                   &lt;int&gt; 318, 405, 525, 309, 405, 534, 314, 405, 530, 1…
## $ Type.3                  &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ Has.Evolution           &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ Evolution.Place         &lt;int&gt; 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1…
## $ Maximum.Evolution.Count &lt;int&gt; 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3…
## $ Evolution.Index         &lt;dbl&gt; 0.33, 0.67, 1.00, 0.33, 0.67, 1.00, 0.33, 0.67…
</pre>
</div>

<h2><a id="add-generation-data-as-a-column" class="anchor" href="#add-generation-data-as-a-column">¶</a>Add Generation Data as a Column</h2><div class="outline-text-2" id="text-org2e43a86">
<p>
Here, we provide the number of Pokemon in each generation, according to PokemonDB, and then use that information to generate a column assigning each Pokemon to their proper generation.
</p>

<pre><span class="org-comment-delimiter"># </span><span class="org-comment">Specify how many pokemon were in each generation</span>
generation_count <span class="org-ess-assignment">&lt;-</span> list(151,100,135,107,156,72,88,96,105)


<span class="org-comment-delimiter"># </span><span class="org-comment">Build the list of generation IDs for each pokemon</span>
generation_id = list()
<span class="org-ess-keyword">for</span> (i <span class="org-ess-keyword">in</span> 1:length(generation_count)) {
  generation_id <span class="org-ess-assignment">&lt;-</span> c(generation_id,rep(i,generation_count[[i]]))
}

<span class="org-comment-delimiter"># </span><span class="org-comment">Add the list as a column in the data</span>
pokedex_data$Generation <span class="org-ess-assignment">&lt;-</span> as.numeric(generation_id)

<span class="org-comment-delimiter"># </span><span class="org-comment">Show a table of the data</span>
kable(pokedex_data[148:153,c(1,2,21)])</pre>

<div class="table-wrapper"><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">Number</th>
<th scope="col" class="org-left">Name</th>
<th scope="col" class="org-right">Generation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">148</td>
<td class="org-right">148</td>
<td class="org-left">Dragonair</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">149</td>
<td class="org-right">149</td>
<td class="org-left">Dragonite</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">150</td>
<td class="org-right">150</td>
<td class="org-left">Mewtwo</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">151</td>
<td class="org-right">151</td>
<td class="org-left">Mew</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">152</td>
<td class="org-right">152</td>
<td class="org-left">Chikorita</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">153</td>
<td class="org-right">153</td>
<td class="org-left">Bayleef</td>
<td class="org-right">2</td>
</tr>
</tbody>
</table></div>
</div>

<h2><a id="add-legendary-status-as-a-column" class="anchor" href="#add-legendary-status-as-a-column">¶</a>Add Legendary Status as a Column</h2><div class="outline-text-2" id="text-org724a993">
<p>
To add legendary status, we&rsquo;ll use the information on Serebii&rsquo;s <a href="https://www.serebii.net/pokemon/legendary.shtml">Legendary Pokemon List</a>. The table their has a thumbnail for each Pokemon and their legendary status. Conveniently, the thumbnail file name is the number of the Pokemon, so we can use that as a key to identify which Pokemon have which legendary status rather than relying on the names in our scraped Pokedex table to match up identically with what&rsquo;s shown in this Serebii table.
</p>

<p>
<b>Note</b>: Serebii provides three unique legendary status categories.
</p>

<ol class="org-ol">
<li>Sub-legendary - Pokemon like Articuno, Zapdos, and Moltres</li>
<li>Legendary - Pokemon like Mewtwo</li>
<li>Mythical - Pokemon like Mew</li>
</ol>

<pre>url <span class="org-ess-assignment">&lt;-</span> <span class="org-string">"https://www.serebii.net/pokemon/legendary.shtml"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Read the body from the page</span>
body <span class="org-ess-assignment">&lt;-</span> url <span class="org-ess-XopX">%&gt;%</span> read_html() <span class="org-ess-XopX">%&gt;%</span> html_nodes(<span class="org-string">"body"</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Get the info cards for each Pokemon</span>
tables <span class="org-ess-assignment">&lt;-</span> html_nodes(body, <span class="org-string">"table.trainer"</span>)

<span class="org-comment-delimiter"># </span><span class="org-comment">Fetch the Pokemon numbers from the source in the table for sub-legendary</span>
sub_legendary_id <span class="org-ess-assignment">&lt;-</span> tables[1] <span class="org-ess-XopX">%&gt;%</span>
  html_nodes(<span class="org-string">"img"</span>) <span class="org-ess-XopX">%&gt;%</span> 
  html_attr(<span class="org-string">"src"</span>)
sub_legendary_id <span class="org-ess-assignment">&lt;-</span> gsub(<span class="org-string">"\\D"</span>, <span class="org-string">""</span>,
                         sub_legendary_id[grepl(<span class="org-string">"*[0-9].png"</span>, 
                                                sub_legendary_id)])
sub_legendary_id <span class="org-ess-assignment">&lt;-</span> as.numeric(sub_legendary_id)

<span class="org-comment-delimiter"># </span><span class="org-comment">Fetch the Pokemon numbers from the source in the table for legendary</span>
legendary_id <span class="org-ess-assignment">&lt;-</span> tables[2] <span class="org-ess-XopX">%&gt;%</span>
  html_nodes(<span class="org-string">"img"</span>) <span class="org-ess-XopX">%&gt;%</span> 
  html_attr(<span class="org-string">"src"</span>)
legendary_id <span class="org-ess-assignment">&lt;-</span> gsub(<span class="org-string">"\\D"</span>, <span class="org-string">""</span>, legendary_id[grepl(<span class="org-string">"*[0-9].png"</span>,legendary_id)])
legendary_id <span class="org-ess-assignment">&lt;-</span> as.numeric(legendary_id)

<span class="org-comment-delimiter"># </span><span class="org-comment">Fetch the Pokemon numbers from the source in the table for mythical</span>
mythical_id <span class="org-ess-assignment">&lt;-</span> tables[3] <span class="org-ess-XopX">%&gt;%</span>
  html_nodes(<span class="org-string">"img"</span>) <span class="org-ess-XopX">%&gt;%</span> 
  html_attr(<span class="org-string">"src"</span>)
mythical_id <span class="org-ess-assignment">&lt;-</span> gsub(<span class="org-string">"\\D"</span>, <span class="org-string">""</span>, mythical_id[grepl(<span class="org-string">"*[0-9].png"</span>, mythical_id)])
mythical_id <span class="org-ess-assignment">&lt;-</span> as.numeric(mythical_id)

<span class="org-comment-delimiter"># </span><span class="org-comment">Trim off any numbers that exceed our current pokedex. This is happening</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">because Serebii has additional pokemon from a recent expansion pack that</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Pokemon DB did not yet have.</span>
sub_legendary_id <span class="org-ess-assignment">&lt;-</span> sub_legendary_id[sub_legendary_id &lt; 
                                       length(pokedex_data$Number)]
legendary_id <span class="org-ess-assignment">&lt;-</span> legendary_id[legendary_id &lt; length(pokedex_data$Number)]
mythical_id <span class="org-ess-assignment">&lt;-</span> mythical_id[mythical_id &lt; length(pokedex_data$Number)]

<span class="org-comment-delimiter"># </span><span class="org-comment">Build the column for legendary status</span>
legendary_status <span class="org-ess-assignment">&lt;-</span> rep(<span class="org-ess-constant">NA</span>,length(pokedex_data$Number))
legendary_status[sub_legendary_id] <span class="org-ess-assignment">&lt;-</span> <span class="org-string">"Sub-Legendary"</span>
legendary_status[legendary_id] <span class="org-ess-assignment">&lt;-</span> <span class="org-string">"Legendary"</span>
legendary_status[mythical_id] <span class="org-ess-assignment">&lt;-</span> <span class="org-string">"Mythical"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Add legendary status as a column for the pokedex data</span>
pokedex_data$Legendary.Status <span class="org-ess-assignment">&lt;-</span> legendary_status

kable(pokedex_data[145:151,c(1,2,22)])</pre>

<div class="table-wrapper"><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-right">Number</th>
<th scope="col" class="org-left">Name</th>
<th scope="col" class="org-left">Legendary.Status</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">145</td>
<td class="org-right">145</td>
<td class="org-left">Zapdos</td>
<td class="org-left">Sub-Legendary</td>
</tr>

<tr>
<td class="org-right">146</td>
<td class="org-right">146</td>
<td class="org-left">Moltres</td>
<td class="org-left">Sub-Legendary</td>
</tr>

<tr>
<td class="org-right">147</td>
<td class="org-right">147</td>
<td class="org-left">Dratini</td>
<td class="org-left">NA</td>
</tr>

<tr>
<td class="org-right">148</td>
<td class="org-right">148</td>
<td class="org-left">Dragonair</td>
<td class="org-left">NA</td>
</tr>

<tr>
<td class="org-right">149</td>
<td class="org-right">149</td>
<td class="org-left">Dragonite</td>
<td class="org-left">NA</td>
</tr>

<tr>
<td class="org-right">150</td>
<td class="org-right">150</td>
<td class="org-left">Mewtwo</td>
<td class="org-left">Legendary</td>
</tr>

<tr>
<td class="org-right">151</td>
<td class="org-right">151</td>
<td class="org-left">Mew</td>
<td class="org-left">Mythical</td>
</tr>
</tbody>
</table></div>
</div>

<h2><a id="write-data-to-output-file" class="anchor" href="#write-data-to-output-file">¶</a>Write Data to Output File</h2><div class="outline-text-2" id="text-orgfb7f314">
<p>
And finally, now that we are done, let&rsquo;s write the resulting table to an output file.
</p>

<pre><span class="org-comment-delimiter"># </span><span class="org-comment">Write data to CSV</span>
write.table(pokedex_data, <span class="org-string">"~/Projects/pokedex/data/pokedex_ext.csv"</span>,
            sep = <span class="org-string">","</span>, row.names = <span class="org-ess-constant">FALSE</span>)</pre>
</div>
</div></div></div><footer class="site-footer"><div class="container"><div class="row"><div class="column"><p><a href="https://github.com/jdylanwhite">GitHub</a> · <a href="https://www.linkedin.com/in/jdylanwhite5">LinkedIn</a> · <a href="mailto:jdylanwhite5@gmail.com">Email</a></p></div><div class="column align-right"><p><a href="https://github.com/jdylanwhite/jdylanwhite.github.io">Site Source</a></p></div></div></div></footer></body></html>
